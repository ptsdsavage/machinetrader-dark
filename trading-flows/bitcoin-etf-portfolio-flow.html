<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bitcoin ETF Portfolio Trading Flow | MachineTrader</title>
  <link rel="canonical" href="https://www.machinetrader.io/trading-flows/bitcoin-etf-portfolio-flow" />
  <meta name="description" content="Create and manage a diversified Bitcoin ETF portfolio with this automated Node-RED trading flow. Includes buy, sell, and performance tracking for 11 Bitcoin ETFs." />
  <meta property="og:title" content="Bitcoin ETF Portfolio Trading Flow | MachineTrader" />
  <meta property="og:description" content="Create and manage a diversified Bitcoin ETF portfolio with this automated Node-RED trading flow. Includes buy, sell, and performance tracking for 11 Bitcoin ETFs." />
  <meta property="og:type" content="website" />
  <meta property="twitter:title" content="Bitcoin ETF Portfolio Trading Flow | MachineTrader" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="google-site-verification" content="google6132bb2f08408978.html" />
  <link rel="icon" href="../images/favicon.svg" type="image/svg+xml" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
          colors: {
            brand: { 50:'#fff8f0',100:'#ffe8cc',200:'#ffd199',300:'#ffb366',400:'#ff9533',500:'#ff6b00',600:'#e05e00',700:'#b84d00',800:'#8f3c00',900:'#662b00',950:'#3d1a00' },
            accent: { 500:'#489fd9',600:'#3a87be' },
            mt: { green:'#4dbd90',purple:'#8668ab',blue:'#489fd9',pink:'#fde5e5',lavender:'#dde7ed' },
            dark: { 900:'#0a0f1a',800:'#111827',700:'#1f2937',600:'#374151' }
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="../css/styles.css" />
  <!-- Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-G9L6L77LNM"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('set','developer_id.dZGVlNj',true);gtag('js',new Date());gtag('config','G-G9L6L77LNM');</script>
  <script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init','1830322441099552');fbq('track','PageView');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5DGHXVQ');</script>
  <style>

    /* Custom styles for code box - Bitcoin ETF Gold Theme */
    .code-container {
      position: relative;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border-radius: 12px;
      margin: 30px 0;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      overflow: hidden;
    }
    
    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: rgba(255, 255, 255, 0.05);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .code-title {
      color: #a0a0a0;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .code-title::before {
      content: "";
      display: inline-block;
      width: 12px;
      height: 12px;
      background: linear-gradient(135deg, #f7931a 0%, #ffc107 100%);
      border-radius: 50%;
    }
    
    .copy-button {
      background: linear-gradient(135deg, #f7931a 0%, #ffc107 100%);
      color: #1a1a2e;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .copy-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(247, 147, 26, 0.4);
    }
    
    .copy-button.copied {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    
    .code-content {
      max-height: 400px;
      overflow-y: auto;
      padding: 20px;
    }
    
    .code-content pre {
      margin: 0;
      color: #e0e0e0;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    
    .code-content::-webkit-scrollbar {
      width: 8px;
    }
    
    .code-content::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }
    
    .code-content::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    .feature-card {
      background: rgba(255,255,255,0.04);
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      margin-bottom: 20px;
      border-left: 4px solid #f7931a;
      transition: transform 0.3s ease;
    }
    
    .feature-card:hover {
      transform: translateY(-3px);
    }
    
    .feature-card h3 {
      color: #f1f5f9;
      margin-bottom: 10px;
      font-size: 18px;
    }
    
    .feature-card p {
      color: #9ca3af;
      margin: 0;
      line-height: 1.6;
    }
    
    .etf-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }
    
    .etf-badge {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #ffc107;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 13px;
      border: 1px solid rgba(255, 193, 7, 0.3);
    }
    
    .etf-badge.featured {
      background: linear-gradient(135deg, #f7931a 0%, #ffc107 100%);
      color: #1a1a2e;
      border: none;
    }
    
    .etf-badge.grayscale {
      background: linear-gradient(135deg, #6b7280 0%, #9ca3af 100%);
      color: white;
      border: none;
    }
    
    .instructions-list {
      background: rgba(255,255,255,0.04);
      border-radius: 12px;
      padding: 25px 25px 25px 45px;
      margin: 20px 0;
    }
    
    .instructions-list li {
      margin-bottom: 12px;
      color: #9ca3af;
      line-height: 1.6;
    }
    
    .instructions-list li strong {
      color: #f1f5f9;
    }
    
    .warning-box {
      background: rgba(245,158,11,0.08);
      border-left: 4px solid #f59e0b;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    
    .warning-box p {
      margin: 0;
      color: #fbbf24;
      font-size: 14px;
    }
    
    .info-box {
      background: rgba(59,130,246,0.08);
      border-left: 4px solid #3b82f6;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    
    .info-box p {
      margin: 0;
      color: #93c5fd;
      font-size: 14px;
    }
    
    .section-divider {
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      margin: 40px 0;
    }
    
    .btc-header {
      background: linear-gradient(135deg, #1a1a2e 0%, #2d1f0f 100%) !important;
    }
    
    .etf-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .stat-card {
      background: rgba(255,255,255,0.04);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.08);
    }
    
    .stat-card .number {
      font-size: 32px;
      font-weight: 700;
      color: #f7931a;
      margin-bottom: 5px;
    }
    
    .stat-card .label {
      font-size: 14px;
      color: #64748b;
    }
  
  </style>
</head>
<body class="bg-black text-gray-100 font-sans antialiased">

  <!-- ============ PASSWORD GATE ============ -->
  <div id="lock-screen" class="fixed inset-0 z-[9999] bg-black flex items-center justify-center">
    <div class="w-full max-w-sm mx-auto px-6">
      <div class="text-center mb-8">
        <img src="../images/logo.svg" alt="MachineTrader" class="h-12 w-auto mx-auto mb-4" />
        <h1 class="text-2xl font-bold tracking-tight mb-2 text-white">MachineTrader‚Ñ¢</h1>
        <p class="text-gray-400 text-sm">Enter the password to view this page.</p>
      </div>
      <form id="password-form" class="space-y-4">
        <div class="relative">
          <input id="password-input" type="password" placeholder="Password" autocomplete="off"
            class="w-full px-4 py-3 rounded-xl bg-gray-900 border border-gray-700 text-white placeholder-gray-500 focus:outline-none focus:border-brand-500 focus:ring-1 focus:ring-brand-500 transition text-sm" />
        </div>
        <button type="submit" class="btn-primary w-full text-sm font-semibold px-6 py-3 rounded-xl">Enter</button>
        <p id="password-error" class="text-red-500 text-xs text-center hidden">Incorrect password. Try again.</p>
      </form>
    </div>
  </div>

  <!-- ============ PAGE CONTENT ============ -->
  <div id="page-content" class="hidden">

  <!-- ============ NAVIGATION ============ -->
  <nav id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
      <div class="flex items-center justify-between h-20">
        <a href="../index.html" class="flex items-center gap-3 group">
          <img src="../images/logo.svg" alt="MachineTrader" class="h-9 w-auto" />
          <span class="text-xl font-bold tracking-tight text-white">MachineTrader‚Ñ¢</span>
        </a>
        <div class="hidden lg:flex items-center gap-8">
          <a href="../index.html" class="nav-link text-sm font-medium text-gray-400 hover:text-white transition">Home</a>
          <a href="../features.html" class="nav-link text-sm font-medium text-gray-400 hover:text-white transition">Features</a>
          <a href="../learn.html" class="nav-link text-sm font-medium text-gray-400 hover:text-white transition">Learn</a>
          <a href="../data-center.html" class="nav-link text-sm font-medium text-gray-400 hover:text-white transition">Data Center</a>
          <a href="../index.html#pricing" class="btn-primary text-sm font-semibold px-6 py-2.5 rounded-full">Start Free Trial</a>
        </div>
        <button id="mobile-menu-btn" class="lg:hidden flex flex-col gap-1.5 p-2" aria-label="Toggle menu">
          <span class="hamburger-line w-6 h-0.5 bg-white rounded transition-all"></span>
          <span class="hamburger-line w-6 h-0.5 bg-white rounded transition-all"></span>
          <span class="hamburger-line w-6 h-0.5 bg-white rounded transition-all"></span>
        </button>
      </div>
    </div>
    <div id="mobile-menu" class="lg:hidden hidden bg-black/95 backdrop-blur-xl border-t border-white/10">
      <div class="max-w-7xl mx-auto px-6 py-6 flex flex-col gap-4">
        <a href="../index.html" class="mobile-nav-link text-base font-medium text-gray-400 hover:text-white py-2">Home</a>
        <a href="../features.html" class="mobile-nav-link text-base font-medium text-gray-400 hover:text-white py-2">Features</a>
        <a href="../learn.html" class="mobile-nav-link text-base font-medium text-gray-400 hover:text-white py-2">Learn</a>
        <a href="../data-center.html" class="mobile-nav-link text-base font-medium text-gray-400 hover:text-white py-2">Data Center</a>
        <div class="flex flex-col gap-3 pt-4 border-t border-white/10">
          <a href="../index.html#pricing" class="btn-primary text-center text-base font-semibold px-6 py-3 rounded-full">Start Free Trial</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- ============ HERO ============ -->
  <section class="relative pt-32 pb-16 overflow-hidden">
    <div class="absolute top-20 left-1/4 w-[500px] h-[500px] bg-amber-500/10 rounded-full blur-[120px] pointer-events-none"></div>
    <div class="absolute bottom-0 right-1/4 w-[400px] h-[400px] bg-yellow-400/10 rounded-full blur-[100px] pointer-events-none"></div>
    <div class="relative max-w-7xl mx-auto px-6 lg:px-8 text-center">
      <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-amber-500/10 border border-amber-500/20 text-amber-500 text-sm font-medium mb-8">
        ‚Çø Crypto Portfolio
      </div>
      <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold tracking-tight mb-6">
        <span class="text-white">Bitcoin ETF Portfolio Trading Flow</span>
      </h1>
      <p class="text-lg text-gray-400 max-w-2xl mx-auto mb-6">Automate a diversified Bitcoin ETF portfolio with buy, sell, and performance tracking for 11 Bitcoin ETFs</p>
      <a href="#flow-json" class="btn-primary text-sm font-semibold px-8 py-3 rounded-full inline-flex items-center gap-2">
        View Flow JSON
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/></svg>
      </a>
    </div>
  </section>

  <!-- ============ MAIN CONTENT ============ -->
  <section class="border-t border-white/5">
    <div class="max-w-5xl mx-auto px-6 lg:px-8 py-16">
<!-- Overview Section -->
<div class="mb-8">
<div class="col-span-full">
<h2 class="text-2xl font-bold text-white mb-4">Overview</h2>
<p>This Node-RED flow creates and manages a diversified portfolio of <strong>11 Bitcoin ETFs</strong> via the Alpaca API. The strategy automatically allocates equal portions of your portfolio across major spot Bitcoin exchange-traded funds, giving you exposure to Bitcoin through traditional stock market instruments.</p>
<!-- Stats Cards -->
<div class="etf-stats">
<div class="stat-card">
<div class="number">11</div>
<div class="label">Bitcoin ETFs</div>
</div>
<div class="stat-card">
<div class="number">$10K</div>
<div class="label">Default Portfolio</div>
</div>
<div class="stat-card">
<div class="number">~$909</div>
<div class="label">Per ETF</div>
</div>
<div class="stat-card">
<div class="number">Day</div>
<div class="label">Order Type</div>
</div>
</div>
<h3 style="margin-top: 25px; margin-bottom: 15px;">Included Bitcoin ETFs</h3>
<div class="etf-badges">
<span class="etf-badge featured">IBIT - iShares Bitcoin Trust</span>
<span class="etf-badge featured">FBTC - Fidelity Wise Origin</span>
<span class="etf-badge">ARKB - ARK 21Shares Bitcoin</span>
<span class="etf-badge">BITB - Bitwise Bitcoin ETF</span>
<span class="etf-badge">HODL - VanEck Bitcoin Trust</span>
<span class="etf-badge">EZBC - Franklin Bitcoin ETF</span>
<span class="etf-badge">BTCO - Invesco Galaxy Bitcoin</span>
<span class="etf-badge">BTCW - WisdomTree Bitcoin</span>
<span class="etf-badge">BRRR - Valkyrie Bitcoin Fund</span>
<span class="etf-badge">DEFI - Hashdex Bitcoin ETF</span>
<span class="etf-badge grayscale">GBTC - Grayscale Bitcoin Trust</span>
</div>
</div>
</div>
<div class="section-divider"></div>
<!-- Features Section -->
<div class="mb-8">
<div class="col-span-full">
<h2 class="text-2xl font-bold text-white mb-4">Key Features</h2>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="">
<div class="feature-card">
<h3>üìà Stock Quote Pricing</h3>
<p>Uses Alpaca's stock data nodes to fetch real-time ETF prices for accurate order quantity calculations during market hours.</p>
</div>
</div>
<div class="">
<div class="feature-card">
<h3>üìä Equal-Weight Allocation</h3>
<p>Automatically divides your $10,000 portfolio equally across all 11 Bitcoin ETFs (~$909 per fund).</p>
</div>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="">
<div class="feature-card">
<h3>‚ö° Rate-Limited Execution</h3>
<p>Built-in 1 order/second rate limiting ensures compliance with API requirements and prevents throttling.</p>
</div>
</div>
<div class="">
<div class="feature-card">
<h3>üí∞ One-Click Liquidation</h3>
<p>Easily close all ETF positions with a single click. Handles both long and short positions automatically.</p>
</div>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="">
<div class="feature-card">
<h3>üìà Performance Analytics</h3>
<p>Track your net gain/loss and percentage returns with built-in performance calculations stored in global variables.</p>
</div>
</div>
<div class="">
<div class="feature-card">
<h3>üîÑ Paper Trading Ready</h3>
<p>Configured for Alpaca Paper Trading by default. Test your Bitcoin ETF strategy risk-free before going live.</p>
</div>
</div>
</div>
<div class="section-divider"></div>
<!-- How to Use Section -->
<div class="mb-8">
<div class="col-span-full">
<h2 class="text-2xl font-bold text-white mb-4">How to Import This Flow</h2>
<ol class="instructions-list">
<li><strong>Copy the JSON code</strong> from the box below by clicking the "Copy to Clipboard" button.</li>
<li><strong>Open your MachineTrader</strong> Node-RED editor.</li>
<li>Click the <strong>hamburger menu</strong> (‚ò∞) in the top-right corner.</li>
<li>Select <strong>Import</strong> from the dropdown menu.</li>
<li><strong>Paste the JSON code</strong> into the import dialog.</li>
<li>Click <strong>Import</strong> to add the flow to your workspace.</li>
<li><strong>Configure your Alpaca credentials</strong> in the configuration nodes (Paper).</li>
<li>Click <strong>Deploy</strong> to activate the flow.</li>
</ol>
<div class="warning-box">
<p><strong>‚ö†Ô∏è Important:</strong> This flow is configured for Alpaca Paper Trading by default. Bitcoin ETF trading involves significant risk and price volatility. Always test thoroughly with paper trading before using real funds. You must configure your own Alpaca API credentials before executing trades.</p>
</div>
<div class="info-box">
<p><strong>üí° Note:</strong> Bitcoin ETFs trade during regular US stock market hours (9:30 AM - 4:00 PM ET, Monday-Friday). Unlike direct cryptocurrency trading, ETF orders use "day" time-in-force and cannot be executed outside market hours. The performance tracking section requires the global <code>ordersPaper</code> variable to be set up in your Global 1 utility tab.</p>
</div>
</div>
</div>
<!-- Code Box Section -->
<div id="flow-json" class="mb-8 scroll-mt-28">
<div class="col-span-full">
<h2 class="text-2xl font-bold text-white mb-4">Node-RED Flow JSON</h2>
<p>Click the button below to copy the complete flow configuration to your clipboard:</p>
<div class="code-container">
<div class="code-header">
<span class="code-title">Create Bitcoin ETF Portfolio.json</span>
<button class="copy-button" onclick="copyCode()">
<svg fill="none" height="16" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="16">
<rect height="13" rx="2" ry="2" width="13" x="9" y="9"></rect>
<path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
</svg>
<span id="copyText">Copy to Clipboard</span>
</button>
</div>
<div class="code-content">
<pre id="jsonCode">[
    {
        "id": "3097de4ab03284c1",
        "type": "tab",
        "label": "Create Bitcoin ETF Portfolio",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "60380f8470540aa2",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "Please refer to the Flow Documentation detailed explanation of this flow.",
        "info": "",
        "x": 300,
        "y": 100,
        "wires": []
    },
    {
        "id": "8e46465aa25cb62b",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "This strategy is ready to run in your paper account. Simply click the gray Inject nodes to activate.",
        "info": "",
        "x": 370,
        "y": 40,
        "wires": []
    },
    {
        "id": "d5c6bf23bde30ffc",
        "type": "pts_oauth_browser",
        "z": "3097de4ab03284c1",
        "callback": "",
        "redirect": "https://docs.google.com/document/d/1kv76H1SjRWc16ORHTCnQbrY2B8EeVI3g1rz9z2EaYtk/edit?usp=sharing",
        "name": "Documentation Link",
        "x": 900,
        "y": 100,
        "wires": []
    },
    {
        "id": "3bb9fd5d08c53902",
        "type": "inject",
        "z": "3097de4ab03284c1",
        "name": "Click Here to Open",
        "props": [
            {
                "p": "redirect",
                "v": "https://docs.google.com/document/d/1JrOxeQVfjAsRMMBDR6p9b-yRzCCs8m8frQoQvqwtjjw/edit",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 690,
        "y": 100,
        "wires": [
            [
                "d5c6bf23bde30ffc"
            ]
        ]
    },
    {
        "id": "18f7e54a7e7112ea",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "Set list of assets to buy",
        "info": "",
        "x": 140,
        "y": 160,
        "wires": []
    },
    {
        "id": "2540ab28551655d4",
        "type": "inject",
        "z": "3097de4ab03284c1",
        "name": "Run once",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 120,
        "y": 200,
        "wires": [
            [
                "743a032b73a75d4a"
            ]
        ]
    },
    {
        "id": "743a032b73a75d4a",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "Store strategy definition",
        "func": "flow.set(\"tickers\", \"ARKB,BITB,IBIT,HODL,EZBC,BTCO,FBTC,BTCW,BRRR,DEFI,GBTC\")\nflow.set(\"portfolioSize\", 10000) // total size of portfolio = $10,000\nflow.set(\"number\", 10) // number of assets to buy\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "d4706afec715342a",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "create market orders",
        "func": "\n//node.warn(msg.payload)\nmsg.ask = Number(msg.payload.ask_price)\nmsg.bid = Number(msg.payload.bid_price)\nif ( msg.ask &gt; 0) { msg.price = msg.ask}\nelse { msg.price = msg.bid}\n\n//node.warn(\"Price: \" +msg.price)\nmsg.portfolio = Number(flow.get(\"portfolioSize\"))\nmsg.number = Number(flow.get(\"number\"))\n//node.warn(msg.portfolio+ \"--\" +msg.number)\n\nmsg.qty = Number(( msg.portfolio / msg.number / msg.price))\nmsg.qty = msg.qty.toFixed(2)\n\n\n// create a unique clientid with unixtime\nlet d = Date.now()\nlet ticker = msg.symbol.replace(\"/\",\"\")\nmsg.client_order_id = ticker + d\n\n\n\nmsg.payload = {\n    \"symbol\": msg.symbol,\n    \"qty\": msg.qty,\n    \"side\": \"buy\",\n    \"type\": 'market',\n //   \"extended_time\": true,\n    \"client_order_id\": msg.client_order_id,\n //   \"limit_price\": msg.price,\n    \"time_in_force\": \"day\"\n};\n\nnode.warn(msg.payload)\n\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 360,
        "wires": [
            [
                "1ea618545dae3923"
            ]
        ]
    },
    {
        "id": "1ea618545dae3923",
        "type": "alpaca-order",
        "z": "3097de4ab03284c1",
        "conf": "0ced618a3a2038f5",
        "x": 550,
        "y": 360,
        "wires": [
            [
                "06a669e5baa39623"
            ]
        ]
    },
    {
        "id": "06a669e5baa39623",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "display error",
        "func": "msg.message = msg.payload[\"message\"]\nmsg.code = msg.payload[\"code\"]\n\n\nif ( msg.message == undefined){\n    //node.warn(\"no errors detected\") \n}\nelse {\n    node.warn(\"Code: \" +msg.code+ \" Message: \" +msg.message) \n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "45fcca5e06b616c1",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "Execute Trades",
        "info": "",
        "x": 120,
        "y": 260,
        "wires": []
    },
    {
        "id": "35c8b85ec5cf069b",
        "type": "inject",
        "z": "3097de4ab03284c1",
        "name": "Run Once",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 120,
        "y": 300,
        "wires": [
            [
                "cb88f4249f2283c5"
            ]
        ]
    },
    {
        "id": "cb88f4249f2283c5",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "get symbols",
        "func": "msg.payload = flow.get(\"tickers\")\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 300,
        "wires": [
            [
                "8ea6a855395878ab"
            ]
        ]
    },
    {
        "id": "8ea6a855395878ab",
        "type": "split",
        "z": "3097de4ab03284c1",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "property": "payload",
        "x": 410,
        "y": 300,
        "wires": [
            [
                "44f43c5b70cdad2b"
            ]
        ]
    },
    {
        "id": "05e3d5ab519631d3",
        "type": "alpaca-order",
        "z": "3097de4ab03284c1",
        "conf": "0ced618a3a2038f5",
        "x": 570,
        "y": 560,
        "wires": [
            [
                "eb18118d63bb4232"
            ]
        ]
    },
    {
        "id": "eb18118d63bb4232",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "display error",
        "func": "msg.message = msg.payload[\"message\"]\nmsg.code = msg.payload[\"code\"]\n\n\nif ( msg.message == undefined){\n    //node.warn(\"no errors detected\") \n}\nelse {\n    node.warn(\"Code: \" +msg.code+ \" Message: \" +msg.message) \n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "eef514d9d3452561",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "Liquidate Position",
        "info": "",
        "x": 130,
        "y": 420,
        "wires": []
    },
    {
        "id": "0ad974f5d3b22f41",
        "type": "inject",
        "z": "3097de4ab03284c1",
        "name": "Run Once",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 120,
        "y": 480,
        "wires": [
            [
                "fe55cbd8eab5f129"
            ]
        ]
    },
    {
        "id": "fe55cbd8eab5f129",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "get symbols",
        "func": "msg.payload = flow.get(\"tickers\")\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 480,
        "wires": [
            [
                "42f5c9134681a708"
            ]
        ]
    },
    {
        "id": "42f5c9134681a708",
        "type": "split",
        "z": "3097de4ab03284c1",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "property": "payload",
        "x": 410,
        "y": 480,
        "wires": [
            [
                "c22880c35daab436"
            ]
        ]
    },
    {
        "id": "e11a2b5f26cae036",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "single msg.symbol",
        "func": "flow.set(\"symbol\", msg.payload)\nmsg.crypto = msg.payload.replace(\"/\",\"\")\nmsg.symbol = msg.crypto\nnode.warn(msg.symbol)\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 480,
        "wires": [
            [
                "cef2950308c65e78"
            ]
        ]
    },
    {
        "id": "cef2950308c65e78",
        "type": "alpaca-position-query",
        "z": "3097de4ab03284c1",
        "conf": "0ced618a3a2038f5",
        "symbol": "",
        "x": 950,
        "y": 480,
        "wires": [
            [
                "d39407a8fc9c90d5"
            ]
        ]
    },
    {
        "id": "d39407a8fc9c90d5",
        "type": "switch",
        "z": "3097de4ab03284c1",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 230,
        "y": 580,
        "wires": [
            [
                "2aaaa2247cabb76f"
            ],
            [
                "4bb2d9269c580cdd"
            ]
        ]
    },
    {
        "id": "4bb2d9269c580cdd",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "no position for symbol",
        "func": "node.warn(\"no position\")\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "c22880c35daab436",
        "type": "delay",
        "z": "3097de4ab03284c1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 550,
        "y": 480,
        "wires": [
            [
                "e11a2b5f26cae036"
            ]
        ]
    },
    {
        "id": "e7f879074ae57173",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "single msg.symbol",
        "func": "msg.symbol = msg.payload\n//node.warn(msg.symbol)\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 300,
        "wires": [
            [
                "1daf3c779c2a1ade"
            ]
        ]
    },
    {
        "id": "44f43c5b70cdad2b",
        "type": "delay",
        "z": "3097de4ab03284c1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 550,
        "y": 300,
        "wires": [
            [
                "e7f879074ae57173"
            ]
        ]
    },
    {
        "id": "2aaaa2247cabb76f",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "prepare trade",
        "func": "msg.symbol = flow.get(\"symbol\")\n\nmsg.side = \"sell\"\n\nif ( msg.payload.side == 'short'){ \n    msg.payload.qty = msg.payload.qty * -1\n    msg.side = 'buy'}\n\n// posible liquidation filters\nmsg.payload.market_value\nmsg.payload.unrealized_plpc\nmsg.payload.qty_available\n\n// for limit trades\nmsg.payload.current_price\n\n    let tradeOrders = {\n        \"symbol\": msg.symbol,\n        \"qty\": msg.payload.qty,\n        \"side\": msg.side,\n        \"type\": \"market\",\n        //  \"extended_hours\": true,\n        //  \"limit_price\": msg.current_price,\n        \"time_in_force\": 'day'\n    } // end tradeOrders\n    node.warn(tradeOrders)\n    msg.payload = tradeOrders\n    return msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 560,
        "wires": [
            [
                "05e3d5ab519631d3"
            ]
        ]
    },
    {
        "id": "1daf3c779c2a1ade",
        "type": "alpaca-data-last-quote",
        "z": "3097de4ab03284c1",
        "conf": "0ced618a3a2038f5",
        "symbol": "",
        "name": "",
        "x": 950,
        "y": 300,
        "wires": [
            [
                "d4706afec715342a"
            ]
        ]
    },
    {
        "id": "eabe32b8aabd47b0",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "Calculate performance",
        "info": "",
        "x": 140,
        "y": 700,
        "wires": []
    },
    {
        "id": "5069c10ad032320d",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "calculate net trades in strategy",
        "func": "// get all orders store in postgres table \"orders_paper\". This table is updated every 60 mins\n// in the Global 1 utility tab by default\n\nlet orders = global.get(\"ordersPaper\")\n//node.warn(orders)\n\n// first filter the orders array by the date the strategy started\nconst cutoff = new Date(\"2025-10-30T00:00:00Z\"); // Oct 30, 2025 UTC\n\nconst array1 = orders.filter(order =&gt; {\n    if (!order.filled_at) return false;\n    const filledDate = new Date(order.filled_at);\n    return filledDate &gt; cutoff;\n});\n//node.warn(array1);\n\n// then include only the tickers in the \nconst tickerString = flow.get(\"tickers\")\n// turn into array\nconst allowedTickers = tickerString.split(\",\");\n// filter orders\nconst array2 = array1.filter(order =&gt;\n    allowedTickers.includes(order.symbol)\n);\n\nnode.warn(array2);\n\n// then add a field for \"trades\" \nconst array3 = array2.map(order =&gt; {\n    const { filled_qty, filled_avg_price, side } = order;\n\n    // validate inputs\n//    if (typeof filled_qty !== \"number\" || typeof filled_avg_price !== \"number\") {\n//        return { ...order, trades: null };\n//    }\n\n    const multiplier = side === \"buy\" ? -1 : 1;\n    const trades = filled_qty * filled_avg_price * multiplier;\n    return { ...order, trades };\n});\n\n// sum all of the trades \n\n// assuming filteredOrders already has a \"trades\" field\nlet totalTrades = array3.reduce((sum, order) =&gt; {\n    // guard against missing or invalid trades values\n    if (typeof order.trades !== \"number\" || isNaN(order.trades)) {\n        return sum;\n    }\n    return sum + order.trades;\n}, 0);\n\ntotalTrades = totalTrades.toFixed(2)\nlet pctTotalTrades = totalTrades / Number(flow.get(\"portfolioSize\")) * 100\npctTotalTrades = pctTotalTrades.toFixed(2)\n\nnode.warn(\"Net trades:\" +totalTrades+ \" Pct trades: \" +pctTotalTrades+ \"%\");\nflow.set(\"netTrades\", totalTrades)\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "c214e5c26dbe8f4a",
        "type": "inject",
        "z": "3097de4ab03284c1",
        "name": "",
        "props": [
            {
                "p": "symbol",
                "v": "OTMCall",
                "vt": "flow"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 85,
        "y": 760,
        "wires": [
            [
                "5069c10ad032320d"
            ]
        ],
        "l": false
    },
    {
        "id": "b073ecfd22496522",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "Requires global ordersPaper created in Global 1",
        "info": "",
        "x": 480,
        "y": 700,
        "wires": []
    },
    {
        "id": "adec633682366826",
        "type": "comment",
        "z": "3097de4ab03284c1",
        "name": "If strategy includes current positions, add current market value of strategy to Net Trades",
        "info": "",
        "x": 340,
        "y": 820,
        "wires": []
    },
    {
        "id": "ca6cc25823c1f854",
        "type": "alpaca-position-query",
        "z": "3097de4ab03284c1",
        "conf": "0ced618a3a2038f5",
        "symbol": "",
        "x": 230,
        "y": 880,
        "wires": [
            [
                "44d4563c2475dbb8"
            ]
        ]
    },
    {
        "id": "44d4563c2475dbb8",
        "type": "function",
        "z": "3097de4ab03284c1",
        "name": "get market value",
        "func": "// include only the tickers in the flow var \"tickers\"  \nlet tickerString = flow.get(\"tickers\")\n\n// split into array\nconst tickers = tickerString.split(\",\");\n// remove \"/\" from each symbol\nconst array1 = tickers.map(t =&gt; t.replace(/\\//g, \"\"));\n\n//node.warn(array1);\n\nlet positions = msg.payload\n//node.warn(positions)\n\n// Filter positions by symbols\nconst filteredPositions = positions.filter(pos =&gt;\n    array1.includes(pos.symbol)\n);\n\n//node.warn(filteredPositions);\n\n// Sum the market_value across filteredPositions\nlet totalMarketValue = filteredPositions.reduce((sum, pos) =&gt; {\n    const value = parseFloat(pos.market_value);\n    return isNaN(value) ? sum : sum + value;\n}, 0);\n\nlet market = totalMarketValue.toFixed(2)\nlet gainloss = Number(flow.get(\"netTrades\")) + totalMarketValue\nlet pctgainloss = gainloss / Number(flow.get(\"portfolioSize\")) * 100\ngainloss = gainloss.toFixed(2)\npctgainloss = pctgainloss.toFixed(2)\n\nnode.warn(\"Total Market Value: \" + market + \" Total Gain or Loss: \" + gainloss + \" Pct Gain or Loss: \" + pctgainloss+ \"%\");\nglobal.set(\"strategyBitcoinGainloss\", gainloss)\nglobal.set(\"strategyBitcoinGainlosspct\", pctgainloss)\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "763fedf5d5c81d4c",
        "type": "inject",
        "z": "3097de4ab03284c1",
        "name": "Run Once",
        "props": [],
        "repeat": "",
        "crontab": "*/1 4-19 * * 1,2,3,4,5",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 85,
        "y": 880,
        "wires": [
            [
                "ca6cc25823c1f854"
            ]
        ],
        "l": false
    },
    {
        "id": "0ced618a3a2038f5",
        "type": "alpaca-account",
        "name": "Paper",
        "keyId": "USE-OAUTH-OR-REPLACE",
        "paper": true
    }
]</pre>
</div>
</div>
</div>
</div>
<div class="section-divider"></div>
<!-- Customization Section -->
<div class="mb-8">
<div class="col-span-full">
<h2 class="text-2xl font-bold text-white mb-4">Customization Options</h2>
<p>You can easily customize this flow to fit your Bitcoin ETF investment goals:</p>
<div class="feature-card">
<h3>üíµ Change Portfolio Size</h3>
<p>Edit the "Store strategy definition" function node to change the <code>portfolioSize</code> value from $10,000 to any amount you prefer.</p>
</div>
<div class="feature-card">
<h3>üìä Modify ETF Selection</h3>
<p>Update the <code>tickers</code> variable to include different Bitcoin ETFs or add other ETFs. Simply use the ticker symbols separated by commas (e.g., "IBIT,FBTC,ARKB"). Remember to update the <code>number</code> variable to match the number of ETFs.</p>
</div>
<div class="feature-card">
<h3>‚è∞ Schedule Automated Execution</h3>
<p>Add cron expressions to the inject nodes to automatically rebalance your Bitcoin ETF portfolio at specific intervals during market hours.</p>
</div>
<div class="feature-card">
<h3>üîÑ Switch to Live Trading</h3>
<p>When you're ready to trade with real money, configure a Live account in the alpaca-account configuration node and update the <code>conf</code> reference in each alpaca node.</p>
</div>
</div>
</div>
    </div>
  </section>

  <!-- ============ CTA ============ -->
  <section class="border-t border-white/5 py-24 text-center">
    <div class="max-w-3xl mx-auto px-6">
      <h2 class="text-3xl sm:text-4xl font-extrabold tracking-tight mb-6 text-white">Ready to Automate Your Trading?</h2>
      <p class="text-gray-400 text-lg mb-10">Import this flow into your MachineTrader‚Ñ¢ instance and start trading automatically.</p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="../index.html#pricing" class="btn-primary text-lg font-semibold px-10 py-4 rounded-full inline-flex items-center gap-2">
          Start Free Trial
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/></svg>
        </a>
        <a href="index.html" class="text-lg font-semibold px-10 py-4 rounded-full border border-white/20 text-white hover:bg-white/5 transition inline-flex items-center gap-2">
          All Trading Flows
        </a>
      </div>
    </div>
  </section>

  <!-- ============ FOOTER ============ -->
  <footer class="bg-gray-950 border-t border-white/10">
    <div class="max-w-7xl mx-auto px-6 lg:px-8 py-16">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-10 mb-16">
        <div class="col-span-2 md:col-span-1">
          <a href="../index.html" class="flex items-center gap-2 mb-4">
            <img src="../images/logo.svg" alt="MachineTrader" class="h-8 w-auto" />
            <span class="text-lg font-bold text-white">MachineTrader‚Ñ¢</span>
          </a>
          <p class="text-sm text-gray-500 leading-relaxed">Automate your trading strategies using our low-code/no-code MachineTrader‚Ñ¢ software.</p>
        </div>
        <div>
          <h4 class="text-sm font-semibold text-brand-500 uppercase mb-4">Product</h4>
          <ul class="space-y-3 text-sm text-gray-500">
            <li><a href="../features.html" class="hover:text-white transition">Features</a></li>
            <li><a href="../index.html#pricing" class="hover:text-white transition">Pricing</a></li>
            <li><a href="../data-center.html" class="hover:text-white transition">Data Center</a></li>
            <li><a href="index.html" class="hover:text-white transition">Trading Scripts</a></li>
            <li><a href="../backtests.html" class="hover:text-white transition">Backtests</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-sm font-semibold text-brand-500 uppercase mb-4">Resources</h4>
          <ul class="space-y-3 text-sm text-gray-500">
            <li><a href="../about-us.html" class="hover:text-white transition">About Us</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-sm font-semibold text-brand-500 uppercase mb-4">Legal</h4>
          <ul class="space-y-3 text-sm text-gray-500">
            <li><a href="../privacy-policy.html" class="hover:text-white transition">Privacy Policy</a></li>
            <li><a href="../terms-of-service.html" class="hover:text-white transition">Terms of Service</a></li>
            <li><a href="../cookie-policy.html" class="hover:text-white transition">Cookie Policy</a></li>
          </ul>
        </div>
      </div>
      <div class="border-t border-white/10 pt-8 flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="text-sm text-gray-500">¬© 2022‚Äì2026 MachineTrader‚Ñ¢. All Rights Reserved. ¬∑ 30 Wall Street, 8th Floor, New York, NY 10005</div>
        <div class="flex items-center gap-6">
          <a href="mailto:info@machinetrader.io" class="text-gray-500 hover:text-white transition text-sm">info@machinetrader.io</a>
        </div>
      </div>
    </div>
    <div class="bg-black border-t border-white/5">
      <div class="max-w-7xl mx-auto px-6 lg:px-8 py-6">
        <p class="text-xs text-gray-600 leading-relaxed">
          <strong class="text-gray-500">Disclaimer:</strong> MachineTrader provides technology for automated trading. All trading involves risk. Past performance is not indicative of future results. MachineTrader is not a registered broker-dealer or investment advisor. Securities trading is offered through Alpaca Securities LLC, member FINRA/SIPC. *Commission-free for U.S. equities.
        </p>
      </div>
    </div>
  </footer>

  </div><!-- end #page-content -->

  <!-- ============ SCRIPTS ============ -->
  <script>
    const EXPECTED_HASH = '8b32a1ee1c55f72d3dd33bdc6cc54b873d7307fe1972855b1cb2d2d11181222f';
    async function sha256(message) {
      const msgBuffer = new TextEncoder().encode(message);
      const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    (async () => {
      const lockScreen = document.getElementById('lock-screen');
      const pageContent = document.getElementById('page-content');
      const form = document.getElementById('password-form');
      const input = document.getElementById('password-input');
      const error = document.getElementById('password-error');
      if (sessionStorage.getItem('mt-auth') === EXPECTED_HASH) {
        lockScreen.classList.add('hidden');
        pageContent.classList.remove('hidden');
      } else { input.focus(); }
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const hash = await sha256(input.value);
        if (hash === EXPECTED_HASH) {
          sessionStorage.setItem('mt-auth', EXPECTED_HASH);
          lockScreen.style.transition = 'opacity 0.4s ease';
          lockScreen.style.opacity = '0';
          setTimeout(() => { lockScreen.classList.add('hidden'); pageContent.classList.remove('hidden'); }, 400);
        } else {
          error.classList.remove('hidden'); input.classList.add('!border-red-500'); input.value = ''; input.focus();
          setTimeout(() => { error.classList.add('hidden'); input.classList.remove('!border-red-500'); }, 3000);
        }
      });
    })();
    
    // Load the JSON file dynamically
    fetch('Create Bitcoin ETF Portfolio.json')
      .then(r => r.ok ? r.text() : Promise.reject('File not found'))
      .then(data => {
        try {
          const jsonObj = JSON.parse(data);
          document.getElementById('jsonCode').textContent = JSON.stringify(jsonObj, null, 2);
        } catch (e) {
          document.getElementById('jsonCode').textContent = data;
        }
      })
      .catch(err => {
        const el = document.getElementById('jsonCode');
        if (el) el.textContent = 'Error loading JSON file. Please download directly using the link below.';
      });
    // Copy to clipboard function
    function copyCode() {
      const codeElement = document.getElementById('jsonCode');
      if (!codeElement) return;
      navigator.clipboard.writeText(codeElement.textContent).then(() => {
        const btn = document.querySelector('.copy-button');
        const txt = document.getElementById('copyText');
        if (btn) btn.classList.add('copied');
        if (txt) txt.textContent = 'Copied!';
        setTimeout(() => {
          if (btn) btn.classList.remove('copied');
          if (txt) txt.textContent = 'Copy to Clipboard';
        }, 2000);
      }).catch(err => console.error('Copy failed:', err));
    }
  </script>
  <script src="../js/main.js"></script>
</body>
</html>